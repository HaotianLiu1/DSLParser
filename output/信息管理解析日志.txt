==================================================
ğŸ“‚ å¼€å§‹è§£æä»»åŠ¡: ä¿¡æ¯ç®¡ç†.dsl
ğŸ•’ æ—¶é—´: Thu Dec 18 15:43:58 CST 2025
--------------------------------------------------
â„¹ï¸ è¯†åˆ«æ¨¡å¼: åŠŸèƒ½æ¨¡å‹ (Function Model)
âœ… è¯­æ³•è§£æé€šè¿‡ (Zero Syntax Errors)

--- [Visitor æ•°æ®æå–ç»“æœ] ---
=== è§£æåŠŸèƒ½æ¨¡å‹: Link16_Difference_Report_Optimized_Commented ===
  [å‘ç°å‚ä¸è€…] åç§°: My_C2_Unit, ç±»å‹: C2_JU
  [å‘ç°å‚ä¸è€…] åç§°: Reporting_Unit, ç±»å‹: GENERIC_PLATFORM
  [å‘ç°å‚ä¸è€…] åç§°: Operator, ç±»å‹: NON_IU
  [å‘ç°å‚ä¸è€…] åç§°: System_Log, ç±»å‹: NON_IU

[é™æ€å®šä¹‰] æ¶ˆæ¯åˆ—è¡¨ (MESSAGES):
  - J2.2
  - J3.2
  - J7.0
  - J2.X
  - J3.X

[é™æ€å®šä¹‰] æšä¸¾é›†åˆ: Identity_Values
  |-- PENDING =0 ("Pending")
  |-- UNKNOWN =1 ("Unknown")
  |-- ASSUMED_FRIEND =2 ("Assumed Friend")
  |-- FRIEND =3 ("Friend")
  |-- NEUTRAL =4 ("Neutral")
  |-- SUSPECT =5 ("Suspect")
  |-- HOSTILE =6 ("Hostile")

[é™æ€å®šä¹‰] æšä¸¾é›†åˆ: EC_Values
  |-- SPACE =1 ("Space")
  |-- AIR =2 ("Air")
  |-- SURF =3 ("Surface")
  |-- SUB =4 ("Subsurface")
  |-- LAND =5 ("Land")
  |-- LAND_PT =6 ("Land Point")
  |-- EW_FIX =7 ("EW Fix")
  |-- EW_AOP =8 ("EW Area of Probability")
  |-- ASW_RB =9 ("ASW Red/Black")
  |-- ASW_POINTS =10 ("ASW Points")

[é™æ€å®šä¹‰] æšä¸¾é›†åˆ: TN_Change_Action
  |-- S =0 ("Same TN")
  |-- N =1 ("New TN")
  |-- X =2 ("Illegal")
  |-- NOT_APPLICABLE =3 ("N/A")
  |-- N_BRACKET_3 =4 ("N(3)")
  |-- BRACKET_2 =5 ("(2)")

[é™æ€å®šä¹‰] æšä¸¾é›†åˆ: ID_Resolution_Action
  |-- NO_ACTION =0 ("No Action")
  |-- ALERT =1 ("Alert Operator")
  |-- ACCEPT =2 ("Auto Accept")
  |-- REJECT =3 ("Auto Reject")
  |-- ALERT_AUTO =4 ("Alert and optionally Auto Accept (1*)")

[é™æ€å®šä¹‰] å…¨å±€çŠ¶æ€: System_Config_IDI1_Action (ç±»å‹: INTEGER) é»˜è®¤å€¼ = 1

[é™æ€å®šä¹‰] æ˜ å°„è¡¨: EC_Change_Rules

[é™æ€å®šä¹‰] æ˜ å°„è¡¨: ID_Resolution_Rules

[è§£ææµç¨‹] Core_Process_Incoming_Data_Conflict (Process Incoming Data Conflict)
    [è§¦å‘æ¡ä»¶] MESSAGE_RECEIVEDJ3.XORMESSAGE_RECEIVEDJ7.0ORMESSAGE_RECEIVEDJ2.X
    [é€»è¾‘åˆ¤æ–­] IF Context.Is_From_PPLI_Report==TRUE
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_PPLI_Update
      |-- -> èµ‹å€¼æ“ä½œ: Local_Track = GET_LOCAL_TRACK(TN=Context.Current_TN)
    [é€»è¾‘åˆ¤æ–­] IF Local_Track==NULL
      |-- è°ƒç”¨å­æµç¨‹: Sub_Log_To_System
      |--     [é€»è¾‘åˆ¤æ–­] IF Context.Remote_EC!=Local_Track.Environment
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_EC_Conflict
      |--     [é€»è¾‘åˆ¤æ–­] ELSE IF Context.Remote_Exercise_Indicator!=Local_Track.Exercise_Indicator
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_Exercise_Indicator_Conflict
    [é€»è¾‘åˆ¤æ–­] ELSE IF Context.Remote_ID!=Local_Track.Identity
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_ID_Conflict
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- 
[è§£ææµç¨‹] Sub_Handle_PPLI_Update (Handle PPLI Update)
    [é€»è¾‘åˆ¤æ–­] IF Context.Remote_EC!=GET_LOCAL_EC(TN=Context.Current_TN)
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_EC_Conflict
-> èµ‹å€¼æ“ä½œ: PPLI_ID_Indicator = Context.Remote_Message_Data.PPLI_Identity_Indicator
    [é€»è¾‘åˆ¤æ–­] IF PPLI_ID_Indicator==1ANDContext.Remote_ID==Identity_Values.FRIENDANDGET_LOCAL_ID(TN=Context.Current_TN)!=Identity_Values.HOSTILE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_Track_Identity
      |-- è°ƒç”¨å­æµç¨‹: Sub_Update_Associated_Data
      |-- è°ƒç”¨å­æµç¨‹: Sub_Report_Local_ID_Change
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_ID_Conflict

[è§£ææµç¨‹] Sub_Handle_EC_Conflict (Handle E/C Conflict)
    (å‚æ•°å®šä¹‰: (base_rule_override:STRING))
-> èµ‹å€¼æ“ä½œ: Local_EC = GET_LOCAL_EC(TN=Context.Current_TN)
    [é€»è¾‘åˆ¤æ–­] IF base_rule_override==""
      |-- -> èµ‹å€¼æ“ä½œ: base_rule = EC_Change_Rules(Local=Local_EC,Remote=Context.Remote_EC)
    [é€»è¾‘åˆ¤æ–­] ELSE
      |--     [é€»è¾‘åˆ¤æ–­] IF base_rule_override=="N"
      |-- -> èµ‹å€¼æ“ä½œ: base_rule = TN_Change_Action.N
    [é€»è¾‘åˆ¤æ–­] ELSE IF base_rule_override=="S"
      |-- -> èµ‹å€¼æ“ä½œ: base_rule = TN_Change_Action.S
    [é€»è¾‘åˆ¤æ–­] ELSE IF base_rule_override=="X"
      |-- -> èµ‹å€¼æ“ä½œ: base_rule = TN_Change_Action.X
    [é€»è¾‘åˆ¤æ–­] ELSE
      |--     -> æ­¥éª¤: æè¿°: "ERROR: Invalid string value received in base_rule_override."
      |--     [é€»è¾‘åˆ¤æ–­] IF base_rule==TN_Change_Action.S
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |-- è°ƒç”¨å­æµç¨‹: Sub_Report_Local_EC_Change
    [é€»è¾‘åˆ¤æ–­] ELSE IF base_rule==TN_Change_Action.N
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |--     [é€»è¾‘åˆ¤æ–­] IF My_C2_Unit.HAS_R2_FOR(TN=Context.Current_TN)==TRUE
      |-- è°ƒç”¨å­æµç¨‹: Link16_Control_Handover_Detailed.Sub_SendMessage
      |-- -> èµ‹å€¼æ“ä½œ: New_TN = GENERATE_NEW_TN
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Link16_Control_Handover_Detailed.Sub_SendMessage
    [é€»è¾‘åˆ¤æ–­] ELSE IF base_rule==TN_Change_Action.N_BRACKET_3
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |--     [é€»è¾‘åˆ¤æ–­] IF GET_ASW_POINT_TYPE(Track=GET_LOCAL_TRACK(TN=Context.Current_TN))IN(1,2,4,5,12)
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_EC_Conflict
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_EC_Conflict
    [é€»è¾‘åˆ¤æ–­] ELSE IF base_rule==TN_Change_Action.BRACKET_2
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |--     [é€»è¾‘åˆ¤æ–­] IF GET_NUMBER_OF_FIXES_FOR_AOP(Data=Context.Remote_Message_Data)==1
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_EC_Conflict
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Sub_Handle_EC_Conflict
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator

[è§£ææµç¨‹] Sub_Report_Local_EC_Change (Report Local E/C Change)
    (å‚æ•°å®šä¹‰: (New_EC:STRING))
    [é€»è¾‘åˆ¤æ–­] IF My_C2_Unit.HAS_R2_FOR(TN=Context.Current_TN)==TRUE
      |-- -> èµ‹å€¼æ“ä½œ: Converted_EC = EC_Values.FromString(Value=New_EC)
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_R2_Next_Report_Data
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Link16_Control_Handover_Detailed.Sub_SendMessage

[è§£ææµç¨‹] Sub_Handle_Exercise_Indicator_Conflict (Handle Exercise Indicator Conflict)
è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator

[è§£ææµç¨‹] Sub_Handle_ID_Conflict (Handle Identity (ID) Conflict)
    [é€»è¾‘åˆ¤æ–­] IF My_C2_Unit.IS_CONTROLLING_UNIT_FOR(TN=Context.Current_TN)==TRUE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |-- è°ƒç”¨å­æµç¨‹: Link16_Control_Handover_Detailed.Sub_SendMessage
      |--     [é€»è¾‘åˆ¤æ–­] IF Context.Is_From_J70_Report==TRUE
      |--     [é€»è¾‘åˆ¤æ–­] IF Context.Remote_CUI_Flag==TRUE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |-- -> èµ‹å€¼æ“ä½œ: Converted_ID = Identity_Values.FromValue(Value=Context.Remote_ID)
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_Track_Identity
      |-- è°ƒç”¨å­æµç¨‹: Sub_Update_Associated_Data
      |-- è°ƒç”¨å­æµç¨‹: Sub_Report_Local_ID_Change
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- -> èµ‹å€¼æ“ä½œ: id_action = ID_Resolution_Rules(Local=GET_LOCAL_ID(TN=Context.Current_TN),Value=Context.Remote_ID)
      |-- è°ƒç”¨å­æµç¨‹: Sub_Resolve_ID_Action_By_Role
    [é€»è¾‘åˆ¤æ–­] ELSE IF Context.Is_From_J3X_Report==TRUE
      |--     [é€»è¾‘åˆ¤æ–­] IF Context.Remote_IDI_Flag==FALSE
      |-- -> èµ‹å€¼æ“ä½œ: id_action = ID_Resolution_Rules(Local=GET_LOCAL_ID(TN=Context.Current_TN),Value=Context.Remote_ID)
      |-- è°ƒç”¨å­æµç¨‹: Sub_Resolve_ID_Action_By_Role
    [é€»è¾‘åˆ¤æ–­] ELSE
      |--     [é€»è¾‘åˆ¤æ–­] IF System_Config_IDI1_Action==1
      |-- -> èµ‹å€¼æ“ä½œ: id_action = ID_Resolution_Rules(Local=GET_LOCAL_ID(TN=Context.Current_TN),Value=Context.Remote_ID)
      |-- è°ƒç”¨å­æµç¨‹: Sub_Resolve_ID_Action_By_Role
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator

[è§£ææµç¨‹] Sub_Resolve_ID_Action_By_Role (Resolve ID Action Based on Unit Role)
    (å‚æ•°å®šä¹‰: (action:INTEGER))
    [é€»è¾‘åˆ¤æ–­] IF My_C2_Unit.HAS_R2_FOR(TN=Context.Current_TN)==TRUE
      |--     [é€»è¾‘åˆ¤æ–­] IF action==ID_Resolution_Action.ACCEPTORaction==ID_Resolution_Action.ALERT_AUTO
      |-- -> èµ‹å€¼æ“ä½œ: Converted_ID = Identity_Values.FromValue(Value=Context.Remote_ID)
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_Track_Identity
      |-- è°ƒç”¨å­æµç¨‹: Sub_Update_Associated_Data
      |-- è°ƒç”¨å­æµç¨‹: Sub_Report_Local_ID_Change
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
    [é€»è¾‘åˆ¤æ–­] ELSE IF action==ID_Resolution_Action.REJECT
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_R2_Next_Report_Data
    [é€»è¾‘åˆ¤æ–­] ELSE
      |--     [é€»è¾‘åˆ¤æ–­] IF action==ID_Resolution_Action.ACCEPTORaction==ID_Resolution_Action.ALERT_AUTO
      |-- -> èµ‹å€¼æ“ä½œ: Converted_ID = Identity_Values.FromValue(Value=Context.Remote_ID)
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_Track_Identity
      |-- è°ƒç”¨å­æµç¨‹: Sub_Update_Associated_Data
      |-- è°ƒç”¨å­æµç¨‹: Sub_Report_Local_ID_Change
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
    [é€»è¾‘åˆ¤æ–­] ELSE IF action==ID_Resolution_Action.REJECT
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |-- è°ƒç”¨å­æµç¨‹: Link16_Control_Handover_Detailed.Sub_SendMessage
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator

[è§£ææµç¨‹] Sub_Update_Associated_Data (Update Associated Data After ID Change)
    (å‚æ•°å®šä¹‰: (TN:INTEGER))
è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
-> èµ‹å€¼æ“ä½œ: Remote_Platform = Context.Remote_Message_Data.Platform
-> èµ‹å€¼æ“ä½œ: Local_Platform = GET_LOCAL_PLATFORM(ReferenceTN=TN)
    [é€»è¾‘åˆ¤æ–­] IF Remote_Platform=="No_Statement"ANDLocal_Platform!="No_Statement"
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
    [é€»è¾‘åˆ¤æ–­] ELSE IF Local_PlatformIN("Tanker","Tanker_Boom")ANDNOT(Remote_PlatformIN("Tanker","Tanker_Boom"))
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Alert_Operator
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Update_Track_Associated_Data
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Update_Track_Associated_Data
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System

[è§£ææµç¨‹] Sub_Report_Local_ID_Change (Report Local ID Change)
    (å‚æ•°å®šä¹‰: (TN:INTEGER,New_ID:INTEGER))
    [é€»è¾‘åˆ¤æ–­] IF My_C2_Unit.HAS_R2_FOR(ReferenceTN=TN)==TRUE
      |-- è°ƒç”¨å­æµç¨‹: Atomic_Set_R2_Next_Report_Data
    [é€»è¾‘åˆ¤æ–­] ELSE
      |-- -> èµ‹å€¼æ“ä½œ: is_cu = My_C2_Unit.IS_CONTROLLING_UNIT_FOR(ReferenceTN=TN)
      |-- è°ƒç”¨å­æµç¨‹: Link16_Control_Handover_Detailed.Sub_SendMessage

[è§£ææµç¨‹] Sub_Log_To_System (Log message to system)
    (å‚æ•°å®šä¹‰: (Message:STRING))
è°ƒç”¨å­æµç¨‹: Atomic_Log_To_System

[è§£ææµç¨‹] Atomic_Alert_Operator (Alert Operator)
    (å‚æ•°å®šä¹‰: (Recipient:STRING,Message:STRING))
    -> æ­¥éª¤: My_C2_UnitNOTIFYMessageTORecipient

[è§£ææµç¨‹] Atomic_Log_To_System (Log to System)
    (å‚æ•°å®šä¹‰: (Message:STRING))
    -> æ­¥éª¤: My_C2_UnitNOTIFYMessageTOSystem_Log

[è§£ææµç¨‹] Atomic_Set_Track_Identity (Set Track's Identity Field)
    (å‚æ•°å®šä¹‰: (TN:INTEGER,New_ID:INTEGER))
-> èµ‹å€¼æ“ä½œ: GET_LOCAL_TRACK(ReferenceTN=TN).Identity = New_ID

[è§£ææµç¨‹] Atomic_Update_Track_Associated_Data (Update Track's Associated Data)
    (å‚æ•°å®šä¹‰: (TN:INTEGER))
-> èµ‹å€¼æ“ä½œ: GET_LOCAL_TRACK(ReferenceTN=TN).Platform = Context.Remote_Message_Data.Platform
-> èµ‹å€¼æ“ä½œ: GET_LOCAL_TRACK(ReferenceTN=TN).Activity = Context.Remote_Message_Data.Activity

[è§£ææµç¨‹] Atomic_Set_R2_Next_Report_Data (Set Data for Next R2 Surveillance Report)
    (å‚æ•°å®šä¹‰: (TN:INTEGER,Identity:INTEGER,Environment:INTEGER,IdentityDifferenceIndicator:INTEGER))
    -> æ­¥éª¤: è‡ªç„¶è¯­è¨€æè¿°: NATURAL_LANGUAGE{INTENT"Queue data update for next R2 report";DESCRIPTION"This unit, as R2 for the track, will include the specified updated data (Identity, E/C, and/or IDI flag) in its next J3.X surveillance transmission for that TN.";}
------------------------------

ğŸ‰ æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼
   - å¯è§†åŒ–å›¾: E:\lht\æ¨¡å‹è½¬æ¢\DSLParser\output\ä¿¡æ¯ç®¡ç†.svg
   - è¯¦ç»†æ—¥å¿—: output/ä¿¡æ¯ç®¡ç†è§£ææ—¥å¿—.txt

